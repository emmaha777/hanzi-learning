# 数据持久性保证说明

## ✅ 数据保存机制

你的学习进度数据保存在**浏览器的 localStorage** 中，这是一个**持久化存储**机制。

### 🔒 数据保存位置

- **存储位置**：浏览器的 localStorage（本地存储）
- **存储键名**：`cn_cards_v1`（主数据）+ `cn_cards_v1_backup`（备份）
- **存储位置**：你的电脑本地，与服务器无关

### 📦 数据持久性保证

**数据会永久保存，除非你手动删除，以下情况数据都会保留：**

✅ **关闭 VSCode** - 数据保留（数据在浏览器中，与 VSCode 无关）  
✅ **关闭 Terminal** - 数据保留（数据在浏览器中，与 Terminal 无关）  
✅ **关闭浏览器标签页** - 数据保留  
✅ **关闭浏览器** - 数据保留  
✅ **重启电脑** - 数据保留  
✅ **关闭开发服务器** - 数据保留（如果部署到网络，服务器关闭也不影响）  
✅ **重新打开网页** - 数据自动加载  

### ⚠️ 数据会丢失的情况

只有在以下情况下，数据才会丢失：

1. **手动清除浏览器缓存**
   - 浏览器设置 → 清除浏览数据 → 选择"Cookie 和其他网站数据"
   - ⚠️ 这会删除所有 localStorage 数据

2. **使用无痕模式并关闭窗口**
   - 无痕模式下，关闭窗口会清除所有数据
   - ✅ 建议：不要使用无痕模式

3. **浏览器存储空间不足**
   - 如果浏览器存储空间满了，可能无法保存新数据
   - ✅ 系统会自动提示，建议定期导出备份

4. **手动点击"重置数据"按钮**
   - 会清除所有数据
   - ✅ 建议：重置前先导出数据备份

## 🔍 如何验证数据已保存

### 方法1：浏览器开发者工具

1. 打开网页
2. 按 `F12` 打开开发者工具
3. 进入 `Application` 标签页（Chrome）或 `存储` 标签页（Firefox）
4. 左侧找到 `Local Storage` → 你的网站域名
5. 查看 `cn_cards_v1` 和 `cn_cards_v1_backup`

### 方法2：控制台日志

打开浏览器控制台（F12），你会看到：
```
✓ localStorage 可用，数据将持久保存
✓ 数据已从本地存储加载：共 X 个汉字，X 个已学会，X 个学习中
数据已保存到 localStorage
```

### 方法3：实际操作测试

1. 学习几个汉字，点击"我认识啦"
2. 关闭浏览器
3. 重新打开网页
4. **数据应该还在！** ✅

## 📊 数据保存时机

数据会在以下时机自动保存：

1. **每次操作后立即保存**
   - 点击"我认识啦" → 立即保存
   - 点击"我记住啦" → 立即保存
   - 点击"有点忘了" → 立即保存
   - 修改设置 → 立即保存

2. **定期自动保存**（每30秒）
   - 即使没有操作，也会自动保存

3. **切换标签页时保存**
   - 切换到其他标签页时自动保存

4. **页面关闭前保存**
   - 关闭标签页或浏览器时自动保存

5. **页面可见性变化时保存**
   - 最小化窗口时自动保存

## 🛡️ 数据备份机制

系统实现了双重备份：

1. **主数据**：`cn_cards_v1`
2. **备份数据**：`cn_cards_v1_backup`

如果主数据损坏，系统会自动从备份恢复。

## 💾 额外备份建议

虽然数据会自动保存，但建议定期导出备份：

1. 点击"导出数据"按钮
2. 下载 JSON 文件到本地
3. 保存到安全的地方（云盘、U盘等）

这样即使浏览器数据丢失，也可以从备份恢复。

## 🔧 本地开发 vs 部署到网络

### 本地开发（localhost:3000）

- ✅ 数据保存在浏览器的 localStorage
- ✅ 关闭 VSCode/Terminal 不影响数据
- ⚠️ 关闭开发服务器后，网页无法访问（但数据还在浏览器中）
- ✅ 重新启动开发服务器后，数据依然存在

### 部署到网络（如 vercel.app）

- ✅ 数据保存在浏览器的 localStorage
- ✅ 与服务器完全无关
- ✅ 服务器关闭也不影响数据
- ✅ 任何设备访问同一域名，数据都在（但每个设备独立）

## 🎯 总结

**你的数据是安全的！**

- ✅ 数据保存在你的浏览器中，与 VSCode、Terminal、服务器无关
- ✅ 关闭任何程序都不会影响数据
- ✅ 重启电脑也不会丢失数据
- ✅ 只有手动清除浏览器缓存才会丢失数据
- ✅ 建议定期导出备份以防万一

**只要你不手动清除浏览器缓存，数据会永久保存！**


